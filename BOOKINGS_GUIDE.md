# Система Управления Бронированиями

## Описание

Реализована полнофункциональная система управления бронированиями с поддержкой:
- Хранения множественных бронирований в базе данных (localStorage)
- Поиска и идентификации бронирований по ФИО гостя
- Отмены бронирований через админ-панель и чат
- Редактирования бронирований (через отмену и пересоздание)
- Автоматической генерации тестовых данных

## Файлы Проекта

### Новые файлы:
- `js/bookings.js` - модуль управления бронированиями
- `css/bookings.css` - стили для секции бронирований
- `BOOKINGS_GUIDE.md` - данная инструкция

### Обновленные файлы:
- `index.html` - добавлена секция бронирований в админ-панель
- `css/styles.css` - добавлен импорт bookings.css
- `js/admin.js` - добавлены функции управления бронированиями в админ-панели
- `js/chat.js` - добавлена интеграция с системой отмены по ФИО

## Функционал

### 1. Админ-панель

#### Генерация тестовых данных:
1. Откройте админ-панель (кнопка с шестеренкой в левом нижнем углу)
2. Прокрутите вниз до секции "Бронювання"
3. Нажмите кнопку "Тестові"
4. Система создаст 18 тестовых бронирований на разных гостей

#### Просмотр бронирований:
- Список всех бронирований с деталями
- Статистика: всего, активных, отмененных
- Поиск по ФИО гостя (в реальном времени)

#### Управление бронированиями:
Для каждого активного бронирования доступны действия:
- **Редагувати** - отмена текущего и создание нового бронирования
- **Скасувати** - отмена бронирования
- **Видалити** - удаление из базы данных навсегда

### 2. Чат-бот

#### Отмена бронирования по ФИО:
Гость может отменить или изменить бронирование через чат, указав ФИО:

**Примеры запросов:**
```
Отменить бронирование для Іванов Петро Сергійович
Отменить броню на имя Петренко Марина
Изменить бронирование Сидоров Олексій
Хочу скасувати бронювання для Коваленко Анна
```

**Процесс:**
1. Чат-бот ищет бронирования по указанному ФИО
2. Показывает найденные активные бронирования с полной информацией
3. Предлагает действия:
   - **Скасувати** - отменить бронирование
   - **Змінити** - отменить текущее и создать новое

#### Без указания ФИО:
Если ФИО не указано в сообщении, система попросит его указать:
```
Пожалуйста, укажите ФИО гостя, чье бронирование нужно отменить или изменить.

Например: "Отменить бронирование для Іванов Петро Сергійович"
```

## Структура Данных Бронирования

```javascript
{
  id: "BKG-XXXXX",           // Уникальный ID
  guestName: "Іванов Петро Сергійович",
  phone: "+380501234567",
  email: "ivanov@example.com",
  checkIn: "2026-01-20",     // YYYY-MM-DD
  checkOut: "2026-01-25",    // YYYY-MM-DD
  roomName: "Делюкс",
  guests: 2,
  specialRequests: "Ранній заїзд",
  status: "confirmed",        // confirmed | cancelled | completed
  totalPrice: 12500,
  nights: 5,                  // Автоматически вычисляется
  createdAt: 1705484400000,
  updatedAt: 1705484400000
}
```

## API Модуля bookings.js

### CRUD операции:
- `addBooking(bookingData)` - создать бронирование
- `getBookingById(bookingId)` - получить по ID
- `getAllBookings()` - получить все бронирования
- `updateBooking(bookingId, updates)` - обновить бронирование
- `deleteBooking(bookingId)` - удалить навсегда
- `cancelBooking(bookingId)` - отменить (статус → cancelled)

### Поиск:
- `findBookingsByName(guestName)` - поиск по ФИО (частичное совпадение)
- `searchBookings(criteria)` - поиск по критериям
- `getActiveBookings()` - только активные
- `getUpcomingBookings()` - предстоящие заезды
- `getCurrentBookings()` - текущие постояльцы

### Утилиты:
- `formatBooking(booking)` - форматирование для отображения
- `generateTestBookings()` - генерация тестовых данных
- `getBookingStats()` - статистика
- `clearAllBookings()` - очистка базы

## Тестовые Гости

После генерации тестовых данных будут созданы бронирования на следующих гостей:

1. Іванов Петро Сергійович
2. Петренко Марина Олександрівна
3. Сидоров Олексій Миколайович
4. Коваленко Анна Петрівна
5. Мельник Сергій Іванович
6. Шевченко Ольга Вікторівна
7. Бондаренко Дмитро Андрійович
8. Ткаченко Наталія Сергіївна
9. Кравченко Володимир Олегович
10. Морозова Тетяна Вікторівна
11. Павленко Ігор Павлович
12. Гриценко Юлія Миколаївна
13. Романенко Андрій Васильович
14. Литвиненко Світлана Олександрівна
15. Семенов Максим Дмитрович
16. Захарова Олена Сергіївна
17. Соколов Артем Вікторович
18. Новікова Ірина Петрівна

## Сценарии Тестирования

### Сценарий 1: Отмена через админ-панель
1. Откройте админ-панель
2. Найдите бронирование через поиск (например, "Іванов")
3. Нажмите "Скасувати"
4. Подтвердите действие
5. Убедитесь, что статус изменился на "Скасовано"

### Сценарий 2: Отмена через чат
1. Откройте чат
2. Напишите: "Отменить бронирование для Петренко Марина"
3. Система найдет и покажет бронирование
4. Нажмите кнопку "Скасувати"
5. Подтвердите отмену
6. Получите подтверждение об отмене

### Сценарий 3: Редактирование через чат
1. Откройте чат
2. Напишите: "Изменить бронирование Сидоров Олексій"
3. Система найдет и покажет бронирование
4. Нажмите кнопку "Змінити"
5. Подтвердите действие
6. Текущее бронирование отменится
7. Система предложит создать новое с новыми параметрами

### Сценарий 4: Поиск несуществующего бронирования
1. Откройте чат
2. Напишите: "Отменить бронирование для Несуществующий Гость"
3. Система сообщит, что бронирование не найдено

### Сценарий 5: Массовый поиск
1. Откройте админ-панель
2. В поле поиска введите "Іван" (часть имени)
3. Система покажет всех гостей с "Іван" в ФИО
4. Очистите поле - вернутся все бронирования

## Особенности Реализации

### 1. Идентификация по ФИО
- Поддерживается частичное совпадение
- Регистронезависимый поиск
- Работает с украинскими, русскими и латинскими именами

### 2. Редактирование через отмену
- Core-уровень: бронирование отменяется в базе
- Для гостя: простой и понятный процесс "отменить и создать новое"
- Сохраняются контактные данные для удобства

### 3. Синхронизация
- Изменения в админ-панели автоматически отражаются в чате
- Изменения в чате автоматически обновляют админ-панель
- Единый источник данных (localStorage)

### 4. Статусы бронирований
- **confirmed** - активное бронирование
- **cancelled** - отменено (сохраняется для истории)
- **completed** - завершено (постоялец выехал)

### 5. Автоматические вычисления
- Количество ночей вычисляется автоматически
- Даты форматируются для отображения (DD.MM.YYYY)
- Цена рассчитывается на основе количества ночей

## Интеграция с Существующей Системой

### Совместимость:
- Работает параллельно со старой системой единичного бронирования
- Не конфликтует с существующим функционалом
- Использует те же стили и компоненты

### Расширяемость:
- Легко добавить новые поля в структуру бронирования
- Можно расширить критерии поиска
- Готова к интеграции с backend API

## Безопасность

- Все данные хранятся локально в localStorage
- Нет передачи данных на внешние серверы
- Подтверждение действий перед удалением/отменой
- Разделение прав: админ-панель и гостевой интерфейс

## Производительность

- Оптимизированный поиск
- Кеширование результатов
- Lazy loading для больших списков (max 500px с прокруткой)
- Минимальное использование памяти

---

**Примечание:** Все тестовые данные генерируются автоматически и содержат реалистичную информацию для удобного тестирования всех функций системы.
